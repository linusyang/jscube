(function(){this.Shape=function(){function a(){this.vertices=[],this.quads=[]}return a}(),this.GraphShape=function(){function a(a,b,c){this.shape=a,this.color=b,this.trans=c}return a}(),this.Camera=function(){function a(){this.transform=new Transform,this.focal_length=1}return a}(),this.CameraState=function(){function a(a,b,c,d,e,f,g){this.setState(a,b,c,d,e,f,g)}return a.prototype.setState=function(a,b,c,d,e,f,g){return this.rotate_x=d,this.rotate_y=e,this.rotate_z=f,this.x=a,this.y=b,this.z=c,this.focal_length=g},a.prototype.setCameraState=function(a){return this.setState(a.x,a.y,a.z,a.rotate_x,a.rotate_y,a.rotate_z,a.focal_length)},a.prototype.dup=function(){return new a(this.x,this.y,this.z,this.rotate_x,this.rotate_y,this.rotate_z,this.focal_length)},a}(),this.AffineMatrix=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){var m;m=[a,b,c,d,e,f,g,h,i,j,k,l],this.e0=m[0],this.e1=m[1],this.e2=m[2],this.e3=m[3],this.e4=m[4],this.e5=m[5],this.e6=m[6],this.e7=m[7],this.e8=m[8],this.e9=m[9],this.e10=m[10],this.e11=m[11]}return a}(),this.RGBA=function(){function a(a,b,c,d){this.setRGBA(a,b,c,d)}return a.prototype.setRGBA=function(a,b,c,d){var e;return e=[a,b,c,d],this.r=e[0],this.g=e[1],this.b=e[2],this.a=e[3],e},a.prototype.setRGB=function(a,b,c){return this.setRGBA(a,b,c,1)},a.prototype.invert=function(){var a;return a=[1-this.r,1-this.g,1-this.b],this.r=a[0],this.g=a[1],this.b=a[2],a},a.prototype.dup=function(){return new a(this.r,this.g,this.b,this.a)},a.prototype.mix=function(a){var b;b=a.a+this.a*(1-a.a),this.r=(a.r*a.a+(1-a.a)*this.r*this.a)/b,this.g=(a.g*a.a+(1-a.a)*this.g*this.a)/b,this.b=(a.b*a.a+(1-a.a)*this.b*this.a)/b,this.a=b},a}(),this.QuadFace=function(){function a(a,b,c,d){this.setQuad(a,b,c,d),this.centroid=null,this.normal1=null,this.normal2=null}return a.prototype.setQuad=function(a,b,c,d){var e;return e=[a,b,c,d],this.i0=e[0],this.i1=e[1],this.i2=e[2],this.i3=e[3],e},a.prototype.setTriangle=function(a,b,c){return this.setQuad(a,b,c,null)},a.prototype.isTriangle=function(){return this.i3==null},a}()}).call(this),function(){this.Transform=function(){function a(){this.reset()}return a.prototype.multiplyAffine=function(a,b){return MatrixUtil.multiplyAffine(a,b)},a.prototype.makeRotateAffineX=function(a){return MatrixUtil.makeRotateAffineX(a)},a.prototype.makeRotateAffineY=function(a){return MatrixUtil.makeRotateAffineY(a)},a.prototype.makeRotateAffineZ=function(a){return MatrixUtil.makeRotateAffineZ(a)},a.prototype.makeTranslateAffine=function(a,b,c){return MatrixUtil.makeTranslateAffine(a,b,c)},a.prototype.makeScaleAffine=function(a,b,c){return MatrixUtil.makeScaleAffine(a,b,c)},a.prototype.reset=function(){this.m=MatrixUtil.makeIdentityAffine()},a.prototype.rotateX=function(a){this.m=this.multiplyAffine(this.makeRotateAffineX(a),this.m)},a.prototype.rotateXPre=function(a){this.m=this.multiplyAffine(this.m,this.makeRotateAffineX(a))},a.prototype.rotateY=function(a){this.m=this.multiplyAffine(this.makeRotateAffineY(a),this.m)},a.prototype.rotateYPre=function(a){this.m=this.multiplyAffine(this.m,this.makeRotateAffineY(a))},a.prototype.rotateZ=function(a){this.m=this.multiplyAffine(this.makeRotateAffineZ(a),this.m)},a.prototype.rotateZPre=function(a){this.m=this.multiplyAffine(this.m,this.makeRotateAffineZ(a))},a.prototype.translate=function(a,b,c){this.m=this.multiplyAffine(this.makeTranslateAffine(a,b,c),this.m)},a.prototype.translatePre=function(a,b,c){this.m=this.multiplyAffine(this.m,this.makeTranslateAffine(a,b,c))},a.prototype.scale=function(a,b,c){this.m=this.multiplyAffine(this.makeScaleAffine(a,b,c),this.m)},a.prototype.scalePre=function(a,b,c){this.m=this.multiplyAffine(this.m,this.makeScaleAffine(a,b,c))},a.prototype.transformPoint=function(a){return MatrixUtil.transformPoint(this.m,a)},a.prototype.multTransform=function(a){this.m=this.multiplyAffine(this.m,a.m)},a.prototype.setDCM=function(a,b,c){var d;d=this.m,d.e0=a.x,d.e4=a.y,d.e8=a.z,d.e1=b.x,d.e5=b.y,d.e9=b.z,d.e2=c.x,d.e6=c.y,d.e10=c.z},a.prototype.dup=function(){var b;return b=new a,b.m=MatrixUtil.dupAffine(this.m),b},a}()}.call(this),function(){this.Context=function(){function a(a){this.ctx_=a.getContext("2d"),this.use_path=!1,this.anti_alias=!0,this.bg_rgba=new RGBA(1,1,1,1),this.setSize(a.width,a.height),this.emptyBuffer();return}return a.prototype.setSize=function(a,b){this.width=a,this.height=b},a.prototype.drawBuffer=function(){this.use_path||this.ctx_.putImageData(this.buffer,0,0)},a.prototype.emptyBuffer=function(){this.use_path||(this.buffer=this.ctx_.createImageData(this.width,this.height))},a.prototype.resetCanvas=function(){this.use_path?this.ctx_.clearRect(0,0,this.width,this.height):(this.emptyBuffer(),this.drawBuffer())},a.prototype.fillRect=function(a,b,c,d){var e,f,g;if(this.use_path)this.ctx_.fillRect(a,b,c,d);else{g=(b*this.width+a)*4,f=b;while(f<=b+c){e=a;while(e<=a+d)this.buffer.data[g]=this.bg_rgba.r*255,this.buffer.data[g+1]=this.bg_rgba.g*255,this.buffer.data[g+2]=this.bg_rgba.b*255,this.buffer.data[g+3]=this.bg_rgba.a*255,g+=4,e+=1;f+=1}this.drawBuffer()}},a.prototype.setFillColor=function(a,b,c,d){var e;e=[Math.floor(a*255),Math.floor(b*255),Math.floor(c*255),d],this.ctx_.fillStyle="rgba("+e.join(",")+")"},a.prototype.antiAliasPoint=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s;o=VectorUtil.pointTriDistance2d(a,b,c,d),g=f?!1:o<0,h=Math.abs(o),p=1.414;if(h<p){j=[{x:a.x-1,y:a.y-1},{x:a.x-1,y:a.y+1},{x:a.x+1,y:a.y-1},{x:a.x+1,y:a.y+1}],s=[];for(q=0,r=j.length;q<r;q++)i=j[q],VectorUtil.pointInTriangle2d(i,b,c,d)?s.push(void 0):(m=(i.y*this.width+i.x)*4,n=h/p,l=new RGBA(this.buffer.data[m]/255,this.buffer.data[m+1]/255,this.buffer.data[m+2]/255,this.buffer.data[m+3]/255),k=new RGBA(e.r,e.g,e.b,e.a*n),g||l.mix(k),this.buffer.data[m]=l.r*255,this.buffer.data[m+1]=l.g*255,this.buffer.data[m+2]=l.b*255,s.push(this.buffer.data[m+3]=l.a*255));return s}},a.prototype.fillTriangle=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;f=Math.round(Math.max(a.x,b.x,c.x)),h=Math.round(Math.min(a.x,b.x,c.x)),g=Math.round(Math.max(a.y,b.y,c.y)),i=Math.round(Math.min(a.y,b.y,c.y)),n=i;while(n<=g){m=h,k=(n*this.width+m)*4;while(m<=f)l={x:m,y:n},VectorUtil.pointInTriangle2d(l,a,b,c)&&(j=new RGBA(this.buffer.data[k]/255,this.buffer.data[k+1]/255,this.buffer.data[k+2]/255,this.buffer.data[k+3]/255),j.mix(d),this.buffer.data[k]=j.r*255,this.buffer.data[k+1]=j.g*255,this.buffer.data[k+2]=j.b*255,this.buffer.data[k+3]=j.a*255,this.anti_alias&&this.antiAliasPoint(l,a,b,c,d,e)),k+=4,m+=1;n+=1}},a.prototype.fillQuadFace=function(a,b){var c;if(!!this.use_path)return this.ctx_.beginPath(),this.ctx_.moveTo(a.i0.x,a.i0.y),this.ctx_.lineTo(a.i1.x,a.i1.y),this.ctx_.lineTo(a.i2.x,a.i2.y),a.isTriangle()!==!0&&this.ctx_.lineTo(a.i3.x,a.i3.y),this.setFillColor(b.r,b.g,b.b,b.a),this.ctx_.fill();c=a.isTriangle(),this.fillTriangle(a.i0,a.i2,a.i1,b,c);if(!c)return this.fillTriangle(a.i0,a.i2,a.i3,b,c)},a}()}.call(this),function(){this.Renderer=function(){function a(a){this.perform_z_sorting=!0,this.draw_overdraw=!0,this.draw_backfaces=!1,this.fill_rgba=new RGBA(1,0,0,1),this.canvas=a,this.ctx=new Context(this.canvas),this.camera=new Camera,this.transform=new Transform,this.quad_callback=null,this.buffered_quads_=null,this.setSize(this.canvas.width,this.canvas.height),this.emptyBuffer();return}return a.prototype.setSize=function(a,b){this.width_=a,this.height_=b,this.scale_=this.height_/2,this.xoff_=this.width_/2,this.canvas.width=a,this.canvas.height=b,this.ctx.setSize(a,b)},a.prototype.emptyBuffer=function(){return this.buffered_quads_=[],this.ctx.emptyBuffer()},a.prototype.resetCanvas=function(){return this.buffered_quads_=[],this.ctx.resetCanvas()},a.prototype.projectPointToCanvas=function(a){var b,c;return c=this.camera.focal_length/-a.z,b=this.scale_,{x:a.x*c*b+this.xoff_,y:a.y*c*-b+b}},a.prototype.projectPointsToCanvas=function(a){var b,c,d,e;e=[];for(c=0,d=a.length;c<d;c++)b=a[c],e.push(this.projectPointToCanvas(b));return e},a.prototype.projectQuadFaceToCanvasIP=function(a){return a.i0=this.projectPointToCanvas(a.i0),a.i1=this.projectPointToCanvas(a.i1),a.i2=this.projectPointToCanvas(a.i2),a.isTriangle()||(a.i3=this.projectPointToCanvas(a.i3)),a},a.prototype.bufferShape=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;c=this.draw_backfaces,i=this.quad_callback,j=MatrixUtil.multiplyAffine(this.camera.transform.m,this.transform.m),k=MatrixUtil.transAdjoint(j),m=MatrixUtil.transformPoints(j,a.vertices),p=a.quads;for(e=n=0,o=p.length;n<o;e=++n){h=p[e];if(i!=null&&i(this,h,e,a)===!0)continue;b=MatrixUtil.transformPoint(j,h.centroid);if(b.z>=-1)continue;f=VectorUtil.unitVector3d(MatrixUtil.transformPoint(k,h.normal1)),g=MatrixUtil.transformPoint(k,h.normal2);if(c!==!0&&VectorUtil.dotProduct3d(b,f)>0&&VectorUtil.dotProduct3d(b,g)>0)continue;d=VectorUtil.dotProduct3d({x:0,y:0,z:1},f),d<0&&(d=0),h.isTriangle()===!0?l=new QuadFace(m[h.i0],m[h.i1],m[h.i2],null):l=new QuadFace(m[h.i0],m[h.i1],m[h.i2],m[h.i3]),l.centroid=b,l.normal1=f,l.normal2=g,this.buffered_quads_.push({qf:l,intensity:d,draw_overdraw:this.draw_overdraw,fill_rgba:this.fill_rgba})}},a.prototype.drawBackground=function(a){return this.ctx.setFillColor(a.r,a.g,a.b,a.a),this.ctx.bg_rgba=a,this.ctx.fillRect(0,0,this.width_,this.height_)},a.prototype.drawBuffer=function(){var a,b,c,d,e,f,g,h,i,j,k;b=this.ctx,a=this.buffered_quads_,f=a.length,this.perform_z_sorting===!0&&a.sort(function(a,b){return a.qf.centroid.z-b.qf.centroid.z});for(j=0,k=a.length;j<k;j++)g=a[j],h=g.qf,this.projectQuadFaceToCanvasIP(h),d=h.isTriangle(),g.draw_overdraw===!0&&(VectorUtil.pushPoints2dIP(h.i0,h.i1),VectorUtil.pushPoints2dIP(h.i1,h.i2),d===!0?VectorUtil.pushPoints2dIP(h.i2,h.i0):(VectorUtil.pushPoints2dIP(h.i2,h.i3),VectorUtil.pushPoints2dIP(h.i3,h.i0))),(c=g.fill_rgba)!=null&&(e=g.intensity,i=new RGBA(c.r*e,c.g*e,c.b*e,c.a),b.fillQuadFace(h,i));return b.drawBuffer(),f},a}()}.call(this),function(){this.Grapher=function(){function a(a){this.renderer=new Renderer(a),this.gshapes=null,this.dtrans=new Transform,this.bg_white=!0,this.black_color=new RGBA(0,0,0,1),this.white_color=new RGBA(1,1,1,1),this.red_color=new RGBA(.86,.08,.24,1),this.orange_color=new RGBA(1,.55,0,1),this.green_color=new RGBA(.2,.8,.2,1),this.cyan_color=new RGBA(.25,.41,.88,1),this.purple_color=new RGBA(.58,0,.83,1),this.pool_num=20,this.color_str="color-random",this.quad_randcolor=function(a,b,c,d){return a.fill_rgba=a.color_pool[c%a.color_pool_num],!1},this.quad_fixcolor=function(a,b,c,d){return a.fill_rgba=a.quad_color,!1},this.genRandColor(this.pool_num),this.quad_callback=this.quad_randcolor}return a.prototype.draw=function(){var a,b,c,d;if(this.gshapes==null)return;this.renderer.resetCanvas(),this.renderer.quad_callback=this.quad_callback,d=this.gshapes;for(b=0,c=d.length;b<c;b++)a=d[b],this.renderer.fill_rgba=a.color!=null?a.color:this.white_color,this.renderer.transform=a.trans!=null?a.trans:this.dtrans,this.renderer.bufferShape(a.shape);this.drawBackground(),this.renderer.drawBuffer()},a.prototype.setSize=function(a,b){this.renderer.setSize(a,b)},a.prototype.drawBackground=function(){var a;a=this.bg_white?this.white_color:this.black_color,this.renderer.ctx.use_path&&this.renderer.drawBackground(a)},a.prototype.toggleBackground=function(){this.bg_white=!this.bg_white,this.draw()},a.prototype.toggleAntiAlias=function(){this.isUsePath()||(this.renderer.ctx.anti_alias=!this.renderer.ctx.anti_alias,this.draw())},a.prototype.isUsePath=function(){return this.renderer.ctx.use_path},a.prototype.togglePath=function(){this.renderer.ctx.use_path=!this.renderer.ctx.use_path,this.draw()},a.prototype.genRandColor=function(a){var b,c;this.renderer.color_pool_num=a,this.renderer.color_pool=[],b=0,c=[];while(b<=this.renderer.color_pool_num)this.renderer.color_pool.push(new RGBA(Math.random(),Math.random(),Math.random(),1)),c.push(b+=1);return c},a.prototype.drawWithColor=function(a){return this.color_str!=="color-custom"&&this.setColor(a),this.draw()},a.prototype.setColor=function(a){var b;this.color_str=a,b=this.white_color;switch(this.color_str){case"color-custom":this.quad_callback=null;return;case"color-random":this.genRandColor(this.pool_num),this.quad_callback=this.quad_randcolor;return;case"color-white":b=this.white_color;break;case"color-red":b=this.red_color;break;case"color-orange":b=this.orange_color;break;case"color-green":b=this.green_color;break;case"color-cyan":b=this.cyan_color;break;case"color-purple":b=this.purple_color}this.renderer.quad_color=b,this.quad_callback=this.quad_fixcolor},a.prototype.genCubes=function(a){var b,c,d,e,f,g,h,i,j,k;c=[];if(a){this.setColor("color-custom"),d=4/3;for(e=i=0;i<=2;e=++i)for(f=j=0;j<=2;f=++j)for(g=k=0;k<=2;g=++k)if(e===0||f===0||g===0||e===2||f===2||g===2)b=ShapeUtil.makeCube(d),h=new Transform,h.translate(2*d*(e-1),2*d*(f-1),2*d*(g-1)),c.push(new GraphShape(b,new RGBA(e/3,f/3,g/3,.3),h))}else this.setColor("color-random"),c.push(new GraphShape(ShapeUtil.makeCube(4),null,null));this.gshapes=c},a.prototype.genTwenty=function(){this.setColor("color-random"),this.gshapes=[new GraphShape(ShapeUtil.makeTwenty(3),null,null)]},a}()}.call(this),function(){this.CameraUtil={registerMouseListener:function(a,b){var c,d,e,f,g,h;h={first_event:!0,is_clicking:!1,last_x:0,last_y:0},g=function(a){var b,c,d;return typeof a.offsetX=="number"?{x:a.offsetX,y:a.offsetY}:(c={x:0,y:0},b=a.target,d=b.offsetParent,d&&(c.x+=b.offsetLeft-d.offsetLeft,c.y+=b.offsetTop-d.offsetTop),{x:a.layerX-c.x,y:a.layerY-c.y})},c=function(a){var b;return b=g(a),h.is_clicking=!0,h.last_x=b.x,h.last_y=b.y,a.preventDefault(),!1},f=function(a){return h.is_clicking=!1,a.preventDefault(),!1},e=f,d=function(a){var c,d,e;return e=g(a),c=h.last_x-e.x,d=h.last_y-e.y,h.last_x=e.x,h.last_y=e.y,h.first_event?h.first_event=!1:b({is_clicking:h.is_clicking,canvas_x:h.last_x,canvas_y:h.last_y,delta_x:c,delta_y:d,shift:a.shiftKey,ctrl:a.ctrlKey||a.metaKey}),a.preventDefault(),!1},a.addEventListener("mousedown",c,!1),a.addEventListener("mouseup",f,!1),a.addEventListener("mouseout",e,!1),a.addEventListener("mousemove",d,!1)},registerTouchListener:function(a,b){var c,d,e,f;c={first_event:!0,is_clicking:!1,last_x:0,last_y:0},f=function(a){return c.is_clicking=!0,c.last_x=a.touches[0].clientX,c.last_y=a.touches[0].clientY,a.preventDefault(),!1},d=function(a){return c.is_clicking=!1,a.preventDefault(),!1},e=function(a){var d,e;return d=c.last_x-a.touches[0].clientX,e=c.last_y-a.touches[0].clientY,c.last_x=a.touches[0].clientX,c.last_y=a.touches[0].clientY,c.first_event?c.first_event=!1:b({is_clicking:c.is_clicking,canvas_x:c.last_x,canvas_y:c.last_y,delta_x:d,delta_y:e,touch:!0,shift:!1,ctrl:!1}),a.preventDefault(),!1},a.addEventListener("touchstart",f,!1),a.addEventListener("touchend",d,!1),a.addEventListener("touchmove",e,!1)},setCamera:function(a,b,c){var d,e;c==null&&(c=!0),e=a.renderer,e.camera.focal_length=b.focal_length,d=e.camera.transform,d.reset(),d.rotateZ(b.rotate_z),d.rotateY(b.rotate_y),d.rotateX(b.rotate_x),d.translate(b.x,b.y,b.z),c&&a.draw()},autoCamera:function(a,b,c){var d,e,f,g;g=a.renderer,c==null&&(c={}),e=null,d=function(a,b,c){return Math.min(b,Math.max(a,c))},f=function(f){var g;if(!f.is_clicking)return;f.shift&&f.ctrl?b.focal_length=d(.05,10,b.focal_length+f.delta_y*.01):f.shift?(b.z+=f.delta_y*.01,c.zAxisLimit!=null&&b.z>c.zAxisLimit&&(b.z=c.zAxisLimit)):f.ctrl?(b.x-=f.delta_x*.01,b.y-=f.delta_y*.01):(b.rotate_y-=f.delta_x*.01,b.rotate_x-=f.delta_y*.01),e!=null&&clearTimeout(e),g=function(){return e=null,CameraUtil.setCamera(a,b)},e=setTimeout(g,0)},this.registerMouseListener(g.canvas,f),this.registerTouchListener(g.canvas,f),this.setCamera(a,b,!1)}}}.call(this),function(){this.VectorUtil={signTriangle2d:function(a,b,c){return(a.x-c.x)*(b.y-c.y)-(b.x-c.x)*(a.y-c.y)},pointInTriangle2d:function(a,b,c,d){var e,f,g;return e=this.signTriangle2d(a,b,c)<0,f=this.signTriangle2d(a,c,d)<0,g=this.signTriangle2d(a,d,b)<0,e===f&&f===g?!0:!1},pointLineDistance2d:function(a,b,c){var d,e,f,g,h,i,j,k,l;return l=[a.x,a.y,b.x,b.y,c.x,c.y],f=l[0],i=l[1],g=l[2],j=l[3],h=l[4],k=l[5],d=Math.abs((h-g)*(j-i)-(g-f)*(k-j)),e=Math.sqrt((h-g)*(h-g)+(k-j)*(k-j)),d/e},pointTriDistance2d:function(a,b,c,d){var e,f;return e=this.pointLineDistance2d(a,b,c),f=Math.min(this.pointLineDistance2d(a,c,d),this.pointLineDistance2d(a,d,b)),e<=f?-e:f},crossProduct:function(a,b){return{x:a.y*b.z-a.z*b.y,y:a.z*b.x-a.x*b.z,z:a.x*b.y-a.y*b.x}},dotProduct2d:function(a,b){return a.x*b.x+a.y*b.y},dotProduct3d:function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z},addPoints2d:function(a,b){return{x:a.x+b.x,y:a.y+b.y}},addPoints3d:function(a,b){return{x:a.x+b.x,y:a.y+b.y,z:a.z+b.z}},addPoints2dIP:function(a,b,c){return a.x=b.x+c.x,a.y=b.y+c.y,a},addPoints3dIP:function(a,b,c){return a.x=b.x+c.x,a.y=b.y+c.y,a.z=b.z+c.z,a},subPoints2d:function(a,b){return{x:a.x-b.x,y:a.y-b.y}},subPoints3d:function(a,b){return{x:a.x-b.x,y:a.y-b.y,z:a.z-b.z}},subPoints2dIP:function(a,b,c){return a.x=b.x-c.x,a.y=b.y-c.y,a},subPoints3dIP:function(a,b,c){return a.x=b.x-c.x,a.y=b.y-c.y,a.z=b.z-c.z,a},mulPoint2d:function(a,b){return{x:a.x*b,y:a.y*b}},mulPoint3d:function(a,b){return{x:a.x*b,y:a.y*b,z:a.z*b}},vecMag2d:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},vecMag3d:function(a){return Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)},unitVector2d:function(a){return this.mulPoint2d(a,1/this.vecMag2d(a))},unitVector3d:function(a){return this.mulPoint3d(a,1/this.vecMag3d(a))},linearInterpolate:function(a,b,c){return(b-a)*c+a},linearInterpolatePoints3d:function(a,b,c){return{x:(b.x-a.x)*c+a.x,y:(b.y-a.y)*c+a.y,z:(b.z-a.z)*c+a.z}},pushPoints2dIP:function(a,b){var c;c=this.unitVector2d(this.subPoints2d(b,a)),this.addPoints2dIP(b,b,c),this.subPoints2dIP(a,a,c)}},this.MatrixUtil={multiplyAffine:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;return A=[a.e0,a.e1,a.e2,a.e3,a.e4,a.e5,a.e6,a.e7,a.e8,a.e9,a.e10,a.e11,b.e0,b.e1,b.e2,b.e3,b.e4,b.e5,b.e6,b.e7,b.e8,b.e9,b.e10,b.e11],c=A[0],d=A[1],g=A[2],h=A[3],i=A[4],j=A[5],k=A[6],l=A[7],m=A[8],n=A[9],e=A[10],f=A[11],o=A[12],p=A[13],s=A[14],t=A[15],u=A[16],v=A[17],w=A[18],x=A[19],y=A[20],z=A[21],q=A[22],r=A[23],new AffineMatrix(c*o+d*u+g*y,c*p+d*v+g*z,c*s+d*w+g*q,c*t+d*x+g*r+h,i*o+j*u+k*y,i*p+j*v+k*z,i*s+j*w+k*q,i*t+j*x+k*r+l,m*o+n*u+e*y,m*p+n*v+e*z,m*s+n*w+e*q,m*t+n*x+e*r+f)},makeIdentityAffine:function(){return new AffineMatrix(1,0,0,0,0,1,0,0,0,0,1,0)},makeRotateAffineX:function(a){var b,c;return c=Math.sin(a),b=Math.cos(a),new AffineMatrix(1,0,0,0,0,b,-c,0,0,c,b,0)},makeRotateAffineY:function(a){var b,c;return c=Math.sin(a),b=Math.cos(a),new AffineMatrix(b,0,c,0,0,1,0,0,-c,0,b,0)},makeRotateAffineZ:function(a){var b,c;return c=Math.sin(a),b=Math.cos(a),new AffineMatrix(b,-c,0,0,c,b,0,0,0,0,1,0)},makeTranslateAffine:function(a,b,c){return new AffineMatrix(1,0,0,a,0,1,0,b,0,0,1,c)},makeScaleAffine:function(a,b,c){return new AffineMatrix(a,0,0,0,0,b,0,0,0,0,c,0)},dupAffine:function(a){return new AffineMatrix(a.e0,a.e1,a.e2,a.e3,a.e4,a.e5,a.e6,a.e7,a.e8,a.e9,a.e10,a.e11)},transAdjoint:function(a){var b,c,d,e,f,g,h,i,j,k;return k=[a.e0,a.e1,a.e2,a.e4,a.e5,a.e6,a.e8,a.e9,a.e10],b=k[0],c=k[1],e=k[2],f=k[3],g=k[4],h=k[5],i=k[6],j=k[7],d=k[8],new AffineMatrix(d*g-h*j,h*i-f*d,f*j-i*g,0,e*j-d*c,d*b-e*i,i*c-b*j,0,h*c-e*g,f*e-h*b,b*g-f*c,0)},transformPoint:function(a,b){return{x:a.e0*b.x+a.e1*b.y+a.e2*b.z+a.e3,y:a.e4*b.x+a.e5*b.y+a.e6*b.z+a.e7,z:a.e8*b.x+a.e9*b.y+a.e10*b.z+a.e11}},transformPoints:function(a,b){var c,d,e,f;f=[];for(d=0,e=b.length;d<e;d++)c=b[d],f.push(this.transformPoint(a,c));return f},averagePoints:function(a){var b,c,d,e,f;b={x:0,y:0,z:0};for(e=0,f=a.length;e<f;e++)d=a[e],b.x+=d.x,b.y+=d.y,b.z+=d.z;return c=1/a.length,b.x*=c,b.y*=c,b.z*=c,b}}}.call(this),function(){this.ShapeUtil={rebuildMeta:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;m=a.vertices,p=a.quads;for(n=0,o=p.length;n<o;n++)e=p[n],i=m[e.i0],j=m[e.i1],k=m[e.i2],f=VectorUtil.subPoints3d(j,i),g=VectorUtil.subPoints3d(k,i),c=VectorUtil.crossProduct(f,g),e.isTriangle()?(d=c,b=MatrixUtil.averagePoints([i,j,k])):(l=m[e.i3],h=VectorUtil.subPoints3d(l,i),d=VectorUtil.crossProduct(g,h),b=MatrixUtil.averagePoints([i,j,k,l])),e.centroid=b,e.normal1=c,e.normal2=d;return a},makeBox:function(a,b,c){var d;return d=new Shape,d.vertices=[{x:a,y:b,z:-c},{x:a,y:b,z:c},{x:a,y:-b,z:c},{x:a,y:-b,z:-c},{x:-a,y:b,z:-c},{x:-a,y:b,z:c},{x:-a,y:-b,z:c},{x:-a,y:-b,z:-c}],d.quads=[new QuadFace(0,1,2,3),new QuadFace(1,5,6,2),new QuadFace(5,4,7,6),new QuadFace(4,0,3,7),new QuadFace(0,4,5,1),new QuadFace(2,6,7,3)],this.rebuildMeta(d)},makeCube:function(a){return this.makeBox(a,a,a)},makeTwenty:function(a){var b,c,d;return b=a,c=b*(Math.sqrt(5)+1)/2,d=new Shape,d.vertices=[{x:-b,y:0,z:c},{x:b,y:0,z:c},{x:-b,y:0,z:-c},{x:b,y:0,z:-c},{x:0,y:c,z:b},{x:0,y:c,z:-b},{x:0,y:-c,z:b},{x:0,y:-c,z:-b},{x:c,y:b,z:0},{x:-c,y:b,z:0},{x:c,y:-b,z:0},{x:-c,y:-b,z:0}],d.quads=[new QuadFace(1,4,0),new QuadFace(4,9,0),new QuadFace(4,5,9),new QuadFace(8,5,4),new QuadFace(1,8,4),new QuadFace(1,10,8),new QuadFace(10,3,8),new QuadFace(8,3,5),new QuadFace(3,2,5),new QuadFace(3,7,2),new QuadFace(3,10,7),new QuadFace(10,6,7),new QuadFace(6,11,7),new QuadFace(6,0,11),new QuadFace(6,1,0),new QuadFace(10,1,6),new QuadFace(11,0,9),new QuadFace(2,11,9),new QuadFace(5,2,9),new QuadFace(11,2,7)],this.rebuildMeta(d)}}}.call(this),function(){$(function(){var a,b,c,d,e,f,g,h,i;window.cubegrapher=new Grapher($("#canvas")[0]),d=window.cubegrapher,d.genCubes(!1),c="color-random",i=new CameraState(0,0,-30,.4,-1.06,0,2.5),e=i.dup(),CameraUtil.autoCamera(d,i),g=function(){var a,b;b=$("#canvas-wrapper").width(),a=$("#canvas-wrapper").height(),$("#canvas").attr("width",""+b+"px"),$("#canvas").attr("height",""+a+"px"),d.setSize(b,a)},h=function(){g(),d.draw()},f=function(){return i.setCameraState(e),CameraUtil.setCamera(d,i)},a=function(){return $("#canvas-wrapper").css("background-color",d.bg_white?"black":"white"),d.toggleBackground()},b=function(){return d.isUsePath()?$("#action-anti").removeClass("disabled"):$("#action-anti").addClass("disabled"),g(),d.togglePath()},$(window).resize(function(){var a,b;return typeof a!="undefined"&&a!==null&&clearTimeout(a),b=function(){return h()},a=setTimeout(b,500)}),$(document).bind("keydown",function(c){if(c==null)return;switch(c.keyCode){case 66:a();break;case 65:d.toggleAntiAlias();break;case 80:b();break;case 82:f()}}),$("#action-color").click(function(a){return $("#action-color").hasClass("disabled")?(a.preventDefault(),!1):($("#color-modal").modal("show"),!0)}),$("#color-cancel").click(function(a){return a.preventDefault(),$("#"+c).prop("checked",!0),$("#color-modal").modal("hide")}),$("#color-ok").click(function(a){return a.preventDefault(),c=$("input[name=colorRadios]:checked").attr("id"),d.drawWithColor(c),$("#color-modal").modal("hide")}),$("#action-reset").click(function(){return f()}),$("#action-background").click(function(){return a()}),$("#action-anti").click(function(a){return d.toggleAntiAlias(),d.isUsePath()?(a.preventDefault(),!1):!0}),$("#action-path").click(function(){return b()}),$("#action-help").click(function(){return $("#help-modal").modal("show")}),$("#help-ok").click(function(a){return a.preventDefault(),$("#help-modal").modal("hide")}),$("#cube-nav li").click(function(a){return $("#cube-nav li.active").removeClass("active"),$(this).hasClass("active")||$(this).addClass("active"),$("#action-color").hasClass("disabled")&&$("#action-color").removeClass("disabled"),a.preventDefault()}),$("#bar-cube").click(function(){return d.genCubes(!1),d.drawWithColor(c)}),$("#bar-rcube").click(function(){return $("#action-color").hasClass("disabled")||$("#action-color").addClass("disabled"),d.genCubes(!0),d.drawWithColor(c)}),$("#bar-twenty").click(function(){return d.genTwenty(),d.drawWithColor(c)}),h()})}.call(this)